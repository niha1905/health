{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!----======== CSS ======== -->
    <link rel="stylesheet" href="{% static 'elderly_monitoring/css/patients.css' %}">
     
    <!----===== Iconscout CSS ===== -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

    <title>Admin Dashboard Panel</title>
</head>
<body>
    <nav>
        <div class="logo-name">
            <div class="logo-image">
               <img src="images/logo.png" alt="">
            </div>

            <span class="logo_name">Nursing Monitoring</span>
        </div>
        <div class="menu-items">
          <ul class="nav-links">
              <li><a href="{% url 'home'%}">
                  <i class="uil uil-estate"></i>
                  <span class="link-name">Dashboard</span>
              </a></li>
              <li><a href="{% url 'about'%}">
                  <i class="uil uil-files-landscapes"></i>
                  <span class="link-name">About</span>
              </a></li>
              <li><a href="{% url 'patients'%}">
                  <i class="uil uil-chart"></i>
                  <span class="link-name">Patients Analytics</span>
              </a></li>
            </ul>
            <ul class="logout-mode">
                <li><a href="#">
                    <i class="uil uil-signout"></i>
                    <span class="link-name">Logout</span>
                </a></li>
                <li class="mode">
                    <a href="#">
                        <i class="uil uil-moon"></i>
                    <span class="link-name">Dark Mode</span>
                </a>
                <div class="mode-toggle">
                  <span class="switch"></span>
                </div>
            </li>
            </ul>
        </div>
    </nav>

    <section class="dashboard">
        <div class="top">
            <i class="uil uil-bars sidebar-toggle"></i>
            <div class="search-box">
                <i class="uil uil-search"></i>
                <input type="text" placeholder="Search here...">
            </div>
        </div>

        <div class="dash-content">
            <div class="overview">
                <div class="title">
                    <i class="uil uil-chart"></i>
                    <span class="text">Patient Analysis</span>
                </div>

                <div class="overlay" data-overlay></div>
              
                
                <div class="clearfix">
                  <section id="heartrate" class="faq">
                    <div class="container" data-aos="fade-up">
                      <div class="section-header">
                        <h2>GIVE US STIPEND</h2>
                      </div>
                      <div class="product-main">
                        <div class="product-grid">
                        </div>
                      </div>
                    </div>
                  </section>
                
                  <table id="patients-table"></table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const tableContainer = document.getElementById('patients-table');

  // Replace with your actual Airtable API key, Base ID, and table name
  const apiKey = 'pat7hpgmy2itPqWrX.da8a874efe149fc7f8569d6297d44973b6175731bb489123aa14de17b35686ae';
  const baseId = 'app2WlcjTHxf5aCIZ';
  const tableName = 'smartwatch_data';

  // Construct the Airtable API URL
  const apiUrl = `https://api.airtable.com/v0/${baseId}/${tableName}`;

  // Set up the headers for the API request
  const headers = {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json',
  };

  // Make the GET request using the Fetch API
  fetch(apiUrl, { headers })
    .then(response => response.json())
    .then(data => {
      const table = document.createElement('table');

      // Add table header
      const thead = document.createElement('thead');
      const headerRow = document.createElement('tr');
      headerRow.innerHTML = `
        <th>Name</th>
        <th>Phone Number</th>
        <th>Nursing Home</th>
        <th>Gender</th>
      `;
      thead.appendChild(headerRow);
      table.appendChild(thead);

      // Add table body
      const tbody = document.createElement('tbody');
      data.records.forEach(record => {
        const name = record.fields['Name'];
        const diagnosis = record.fields['Phone Number'];
        const condition = record.fields['nursing home'];
        const gender = record.fields['gender'];

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${name || 'N/A'}</td>
          <td>${diagnosis || 'N/A'}</td>
          <td>${condition || 'N/A'}</td>
          <td>${gender || 'N/A'}</td>
        `;
        tbody.appendChild(row);
      });
      table.appendChild(tbody);

      // Append table to the container
      tableContainer.appendChild(table);
    })
    .catch(error => {
      console.error('Error fetching data:', error);
      // Handle errors here, e.g., display an error message to the user
    });
});
</script>
</body>
</html>
